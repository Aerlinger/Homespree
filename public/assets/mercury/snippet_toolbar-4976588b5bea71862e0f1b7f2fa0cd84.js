(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};this.Mercury.SnippetToolbar=function(n){function r(e,t){this.document=e,this.options=t!=null?t:{},this._boundEvents=[],r.__super__.constructor.call(this,this.options)}return t(r,n),r.prototype.build=function(){var t,n,r,i,s,o;this.element=jQuery("<div>",{"class":"mercury-toolbar mercury-snippet-toolbar",style:"display:none"}),this.element.appendTo((i=jQuery(this.options.appendTo).get(0))!=null?i:"body"),s=Mercury.config.toolbars.snippets,o=[];for(n in s){if(!e.call(s,n))continue;r=s[n],t=this.buildButton(n,r),t?o.push(t.appendTo(this.element)):o.push(void 0)}return o},r.prototype.bindEvents=function(){var e=this;return this.bindReleasableEvent(Mercury,"show:toolbar",function(t,n){if(!n.snippet)return;return n.snippet.mouseout(function(){return e.hide()}),e.show(n.snippet)}),this.bindReleasableEvent(Mercury,"hide:toolbar",function(t,n){if(!n.type||n.type!=="snippet")return;return e.hide(n.immediately)}),this.bindReleasableEvent(jQuery(this.document),"scroll",function(){if(e.visible)return e.position()}),this.element.mousemove(function(){return clearTimeout(e.hideTimeout)}),this.element.mouseout(function(){return e.hide()})},r.prototype.bindReleasableEvent=function(e,t,n){return e.on(t,n),this._boundEvents.push([e,t,n])},r.prototype.show=function(e){return this.snippet=e,Mercury.tooltip.hide(),this.position(),this.appear()},r.prototype.position=function(){var e,t,n;return t=this.snippet.offset(),n=t.top+Mercury.displayRect.top-jQuery(this.document).scrollTop()-this.height()+10,e=t.left-jQuery(this.document).scrollLeft(),this.element.css({top:n,left:e})},r.prototype.appear=function(){clearTimeout(this.hideTimeout);if(this.visible)return;return this.visible=!0,this.element.css({display:"block",opacity:0}),this.element.stop().animate({opacity:1},200,"easeInOutSine")},r.prototype.hide=function(e){var t=this;return e==null&&(e=!1),clearTimeout(this.hideTimeout),e?(this.element.hide(),this.visible=!1):this.hideTimeout=setTimeout(function(){return t.element.stop().animate({opacity:0},300,"easeInOutSine",function(){return t.element.hide()}),t.visible=!1},500)},r.prototype.release=function(){var e,t,n,r,i,s,o;this.element.off(),this.element.remove(),s=this._boundEvents;for(r=0,i=s.length;r<i;r++)o=s[r],n=o[0],e=o[1],t=o[2],n.off(e,t);return this._boundEvents=[]},r}(Mercury.Toolbar)}).call(this);