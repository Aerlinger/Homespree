!function(){this.Mercury.Dialog=function(){function t(t,e,i){this.url=t,this.name=e,this.options=null!=i?i:{},this.button=this.options["for"],this.build(),this.bindEvents(),this.preload()}return t.prototype.build=function(){var t;return this.element=jQuery("<div>",{"class":"mercury-dialog mercury-"+this.name+"-dialog loading",style:"display:none"}),this.element.appendTo(null!=(t=jQuery(this.options.appendTo).get(0))?t:"body")},t.prototype.bindEvents=function(){return this.element.on("mousedown",function(t){return t.stopPropagation()})},t.prototype.preload=function(){return this.options.preload?this.load():void 0},t.prototype.toggle=function(){return this.visible?this.hide():this.show()},t.prototype.resize=function(){return this.show()},t.prototype.show=function(){return Mercury.trigger("hide:dialogs",this),this.visible=!0,this.loaded?(this.element.css({width:"auto",height:"auto"}),this.position(this.visible)):this.position(),this.appear()},t.prototype.position=function(){},t.prototype.appear=function(){var t=this;return this.element.css({display:"block",opacity:0}),this.element.animate({opacity:.95},200,"easeInOutSine",function(){return t.loaded?void 0:t.load(function(){return t.resize()})})},t.prototype.hide=function(){return this.element.hide(),this.visible=!1},t.prototype.load=function(t){var e=this;if(this.url)return Mercury.preloadedViews[this.url]?(this.loadContent(Mercury.preloadedViews[this.url]),Mercury.dialogHandlers[this.name]&&Mercury.dialogHandlers[this.name].call(this),t?t():void 0):jQuery.ajax(this.url,{success:function(i){return e.loadContent(i),Mercury.dialogHandlers[e.name]&&Mercury.dialogHandlers[e.name].call(e),t?t():void 0},error:function(){return e.hide(),e.button&&e.button.removeClass("pressed"),Mercury.notify('Mercury was unable to load %s for the "%s" dialog.',e.url,e.name)}})},t.prototype.loadContent=function(t){return this.loaded=!0,this.element.removeClass("loading"),this.element.html(t),Mercury.config.localization.enabled?this.element.localize(Mercury.locale()):void 0},t}()}.call(this);