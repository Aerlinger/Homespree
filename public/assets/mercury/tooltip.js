(function(){this.Mercury.tooltip=function(e,t,n){return n==null&&(n={}),Mercury.tooltip.show(e,t,n),Mercury.tooltip},jQuery.extend(Mercury.tooltip,{show:function(e,t,n){return this.forElement=e,this.content=t,this.options=n!=null?n:{},this.document=this.forElement.get(0).ownerDocument,this.initialize(),this.visible?this.update():this.appear()},initialize:function(){if(this.initialized)return;return this.build(),this.bindEvents(),this.initialized=!0},build:function(){var e;return this.element=jQuery("<div>",{"class":"mercury-tooltip"}),this.element.appendTo((e=jQuery(this.options.appendTo).get(0))!=null?e:"body")},bindEvents:function(){var e,t,n,r,i=this;Mercury.on("resize",function(){if(i.visible)return i.position()}),this.element.on("mousedown",function(e){return e.preventDefault(),e.stopPropagation()}),r=this.forElement.parentsUntil(jQuery("body",this.document));for(t=0,n=r.length;t<n;t++){e=r[t];if(!(e.scrollHeight>e.clientHeight))continue;jQuery(e).on("scroll",function(){if(i.visible)return i.position()})}return jQuery(this.document).on("scroll",function(){if(i.visible)return i.position()})},appear:function(){var e=this;return this.update(),this.element.show(),this.element.animate({opacity:1},200,"easeInOutSine",function(){return e.visible=!0})},update:function(){return this.element.html(this.content),this.position()},position:function(){var e,t,n,r;return t=this.forElement.offset(),r=this.element.width(),n=t.top+(Mercury.displayRect.top-jQuery(this.document).scrollTop())+this.forElement.outerHeight(),e=t.left-jQuery(this.document).scrollLeft(),e+r+25>Mercury.displayRect.width&&(e=e-(e+r+25)-Mercury.displayRect.width),e=e<=0?0:e,this.element.css({top:n,left:e})},hide:function(){if(!this.initialized)return;return this.element.hide(),this.visible=!1}})}).call(this);