(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};this.Mercury.Panel=function(e){function n(e,t,r){this.url=e,this.name=t,this.options=r!=null?r:{},n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.build=function(){var e;return this.element=jQuery("<div>",{"class":"mercury-panel loading",style:"display:none;"}),this.titleElement=jQuery("<h1><span>"+Mercury.I18n(this.options.title)+"</span></h1>").appendTo(this.element),this.paneElement=jQuery("<div>",{"class":"mercury-panel-pane"}).appendTo(this.element),this.options.closeButton&&jQuery("<a/>",{"class":"mercury-panel-close"}).appendTo(this.titleElement).css({opacity:0}),this.element.appendTo((e=jQuery(this.options.appendTo).get(0))!=null?e:"body")},n.prototype.bindEvents=function(){var e=this;return Mercury.on("resize",function(){return e.position(e.visible)}),Mercury.on("hide:panels",function(t,n){if(n===e)return;return e.button.removeClass("pressed"),e.hide()}),this.titleElement.find(".mercury-panel-close").on("click",function(e){return e.preventDefault(),Mercury.trigger("hide:panels")}),this.element.on("mousedown",function(e){return e.stopPropagation()}),this.element.on("ajax:beforeSend",function(t,n,r){return r.success=function(t){return e.loadContent(t),e.resize()}}),n.__super__.bindEvents.apply(this,arguments)},n.prototype.show=function(){return Mercury.trigger("hide:panels",this),n.__super__.show.apply(this,arguments)},n.prototype.resize=function(){var e,t,n,r=this;this.titleElement.find(".mercury-panel-close").css({opacity:0}),this.paneElement.css({display:"none"}),n=this.element.width(),this.paneElement.css({visibility:"hidden",width:"auto",display:"block"}),t=this.element.width(),this.paneElement.css({visibility:"visible",display:"none"}),e=this.element.offset(),this.element.animate({left:e.left-(t-n),width:t},200,"easeInOutSine",function(){return r.titleElement.find(".mercury-panel-close").animate({opacity:1},100),r.paneElement.css({display:"block",width:t}),jQuery(r.paneElement.find(".focusable").get(0)).focus(),r.makeDraggable()});if(!this.visible)return this.hide()},n.prototype.position=function(e){var t,n,r,i,s;this.element.css({display:"block",visibility:"hidden"}),i=this.element.offset(),t=this.element.width(),n=Mercury.displayRect.height-16,s=n-this.titleElement.outerHeight(),this.paneElement.css({height:s,overflowY:s<30?"hidden":"auto"}),this.moved||(r=Mercury.displayRect.width-t-20),r<=8&&(r=8);if(this.pinned||t+i.left>Mercury.displayRect.width-20)r=Mercury.displayRect.width-t-20;this.element.css({top:Mercury.displayRect.top+8,left:r,height:n,display:e?"block":"none",visibility:"visible"}),this.makeDraggable();if(!e)return this.element.hide()},n.prototype.loadContent=function(e){this.loaded=!0,this.element.removeClass("loading"),this.paneElement.css({visibility:"hidden"}),this.paneElement.html(e);if(Mercury.config.localization.enabled)return this.paneElement.localize(Mercury.locale())},n.prototype.makeDraggable=function(){var e,t=this;return e=this.element.width(),this.element.draggable({handle:"h1 span",axis:"x",opacity:.7,scroll:!1,addClasses:!1,iframeFix:!0,containment:[8,0,Mercury.displayRect.width-e-20,0],stop:function(){var n;return n=t.element.offset().left,t.moved=!0,t.pinned=n>Mercury.displayRect.width-e-30?!0:!1,!0}})},n}(Mercury.Dialog)}).call(this);