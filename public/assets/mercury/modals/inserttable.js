!function(){this.Mercury.modalHandlers.insertTable={initialize:function(){var e=this;return this.table=this.element.find("#table_display table"),this.table.on("click",function(t){return e.onCellClick($(t.target))}),this.element.find("#table_alignment").on("change",function(){return e.setTableAlignment()}),this.element.find("#table_border").on("keyup",function(){return e.setTableBorder()}),this.element.find("#table_spacing").on("keyup",function(){return e.setTableCellSpacing()}),this.element.find("[data-action]").on("click",function(t){return t.preventDefault(),e.onActionClick(jQuery(t.target).data("action"))}),this.selectFirstCell(),this.element.find("form").on("submit",function(t){return t.preventDefault(),e.submitForm(),e.hide()})},selectFirstCell:function(){var e;return e=this.table.find("td, th").first(),e.addClass("selected"),Mercury.tableEditor(this.table,e,"&nbsp;")},onCellClick:function(e){return this.cell=e,this.table=this.cell.closest("table"),this.table.find(".selected").removeAttr("class"),this.cell.addClass("selected"),Mercury.tableEditor(this.table,this.cell,"&nbsp;")},onActionClick:function(e){return e?Mercury.tableEditor[e]():void 0},setTableAlignment:function(){return this.table.attr({align:this.element.find("#table_alignment").val()})},setTableBorder:function(){var e;return e=parseInt(this.element.find("#table_border").val(),10),isNaN(e)?this.table.removeAttr("border"):this.table.attr({border:e})},setTableCellSpacing:function(){var e;return e=parseInt(this.element.find("#table_spacing").val(),10),isNaN(e)?this.table.removeAttr("cellspacing"):this.table.attr({cellspacing:e})},submitForm:function(){var e,t;return this.table.find(".selected").removeAttr("class"),this.table.find("td, th").html("<br/>"),e=jQuery("<div>").html(this.table).html(),t=e.replace(/^\s+|\n/gm,"").replace(/(<\/.*?>|<table.*?>|<tbody>|<tr>)/g,"$1\n"),Mercury.trigger("action",{action:"insertTable",value:t})}}}.call(this);