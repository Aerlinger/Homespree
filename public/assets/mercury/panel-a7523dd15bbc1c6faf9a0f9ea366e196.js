(function(){var t={}.hasOwnProperty,e=function(e,i){function n(){this.constructor=e}for(var s in i)t.call(i,s)&&(e[s]=i[s]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e};this.Mercury.Panel=function(t){function i(t,e,n){this.url=t,this.name=e,this.options=null!=n?n:{},i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.build=function(){var t;return this.element=jQuery("<div>",{"class":"mercury-panel loading",style:"display:none;"}),this.titleElement=jQuery("<h1><span>"+Mercury.I18n(this.options.title)+"</span></h1>").appendTo(this.element),this.paneElement=jQuery("<div>",{"class":"mercury-panel-pane"}).appendTo(this.element),this.options.closeButton&&jQuery("<a/>",{"class":"mercury-panel-close"}).appendTo(this.titleElement).css({opacity:0}),this.element.appendTo(null!=(t=jQuery(this.options.appendTo).get(0))?t:"body")},i.prototype.bindEvents=function(){var t=this;return Mercury.on("resize",function(){return t.position(t.visible)}),Mercury.on("hide:panels",function(e,i){return i!==t?(t.button.removeClass("pressed"),t.hide()):void 0}),this.titleElement.find(".mercury-panel-close").on("click",function(t){return t.preventDefault(),Mercury.trigger("hide:panels")}),this.element.on("mousedown",function(t){return t.stopPropagation()}),this.element.on("ajax:beforeSend",function(e,i,n){return n.success=function(e){return t.loadContent(e),t.resize()}}),i.__super__.bindEvents.apply(this,arguments)},i.prototype.show=function(){return Mercury.trigger("hide:panels",this),i.__super__.show.apply(this,arguments)},i.prototype.resize=function(){var t,e,i,n=this;return this.titleElement.find(".mercury-panel-close").css({opacity:0}),this.paneElement.css({display:"none"}),i=this.element.width(),this.paneElement.css({visibility:"hidden",width:"auto",display:"block"}),e=this.element.width(),this.paneElement.css({visibility:"visible",display:"none"}),t=this.element.offset(),this.element.animate({left:t.left-(e-i),width:e},200,"easeInOutSine",function(){return n.titleElement.find(".mercury-panel-close").animate({opacity:1},100),n.paneElement.css({display:"block",width:e}),jQuery(n.paneElement.find(".focusable").get(0)).focus(),n.makeDraggable()}),this.visible?void 0:this.hide()},i.prototype.position=function(t){var e,i,n,s,r;return this.element.css({display:"block",visibility:"hidden"}),s=this.element.offset(),e=this.element.width(),i=Mercury.displayRect.height-16,r=i-this.titleElement.outerHeight(),this.paneElement.css({height:r,overflowY:30>r?"hidden":"auto"}),this.moved||(n=Mercury.displayRect.width-e-20),8>=n&&(n=8),(this.pinned||e+s.left>Mercury.displayRect.width-20)&&(n=Mercury.displayRect.width-e-20),this.element.css({top:Mercury.displayRect.top+8,left:n,height:i,display:t?"block":"none",visibility:"visible"}),this.makeDraggable(),t?void 0:this.element.hide()},i.prototype.loadContent=function(t){return this.loaded=!0,this.element.removeClass("loading"),this.paneElement.css({visibility:"hidden"}),this.paneElement.html(t),Mercury.config.localization.enabled?this.paneElement.localize(Mercury.locale()):void 0},i.prototype.makeDraggable=function(){var t,e=this;return t=this.element.width(),this.element.draggable({handle:"h1 span",axis:"x",opacity:.7,scroll:!1,addClasses:!1,iframeFix:!0,containment:[8,0,Mercury.displayRect.width-t-20,0],stop:function(){var i;return i=e.element.offset().left,e.moved=!0,e.pinned=i>Mercury.displayRect.width-t-30?!0:!1,!0}})},i}(Mercury.Dialog)}).call(this);