(function(){var t={}.hasOwnProperty,e=function(e,i){function n(){this.constructor=e}for(var s in i)t.call(i,s)&&(e[s]=i[s]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e};this.Mercury.SnippetToolbar=function(i){function n(t,e){this.document=t,this.options=null!=e?e:{},this._boundEvents=[],n.__super__.constructor.call(this,this.options)}return e(n,i),n.prototype.build=function(){var e,i,n,s,r,o;this.element=jQuery("<div>",{"class":"mercury-toolbar mercury-snippet-toolbar",style:"display:none"}),this.element.appendTo(null!=(s=jQuery(this.options.appendTo).get(0))?s:"body"),r=Mercury.config.toolbars.snippets,o=[];for(i in r)t.call(r,i)&&(n=r[i],e=this.buildButton(i,n),e?o.push(e.appendTo(this.element)):o.push(void 0));return o},n.prototype.bindEvents=function(){var t=this;return this.bindReleasableEvent(Mercury,"show:toolbar",function(e,i){return i.snippet?(i.snippet.mouseout(function(){return t.hide()}),t.show(i.snippet)):void 0}),this.bindReleasableEvent(Mercury,"hide:toolbar",function(e,i){return i.type&&"snippet"===i.type?t.hide(i.immediately):void 0}),this.bindReleasableEvent(jQuery(this.document),"scroll",function(){return t.visible?t.position():void 0}),this.element.mousemove(function(){return clearTimeout(t.hideTimeout)}),this.element.mouseout(function(){return t.hide()})},n.prototype.bindReleasableEvent=function(t,e,i){return t.on(e,i),this._boundEvents.push([t,e,i])},n.prototype.show=function(t){return this.snippet=t,Mercury.tooltip.hide(),this.position(),this.appear()},n.prototype.position=function(){var t,e,i;return e=this.snippet.offset(),i=e.top+Mercury.displayRect.top-jQuery(this.document).scrollTop()-this.height()+10,t=e.left-jQuery(this.document).scrollLeft(),this.element.css({top:i,left:t})},n.prototype.appear=function(){return clearTimeout(this.hideTimeout),this.visible?void 0:(this.visible=!0,this.element.css({display:"block",opacity:0}),this.element.stop().animate({opacity:1},200,"easeInOutSine"))},n.prototype.hide=function(t){var e=this;return null==t&&(t=!1),clearTimeout(this.hideTimeout),t?(this.element.hide(),this.visible=!1):this.hideTimeout=setTimeout(function(){return e.element.stop().animate({opacity:0},300,"easeInOutSine",function(){return e.element.hide()}),e.visible=!1},500)},n.prototype.release=function(){var t,e,i,n,s,r,o;for(this.element.off(),this.element.remove(),r=this._boundEvents,n=0,s=r.length;s>n;n++)o=r[n],i=o[0],t=o[1],e=o[2],i.off(t,e);return this._boundEvents=[]},n}(Mercury.Toolbar)}).call(this);