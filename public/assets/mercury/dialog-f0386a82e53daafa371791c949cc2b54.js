(function(){this.Mercury.Dialog=function(){function e(e,t,n){this.url=e,this.name=t,this.options=n!=null?n:{},this.button=this.options["for"],this.build(),this.bindEvents(),this.preload()}return e.prototype.build=function(){var e;return this.element=jQuery("<div>",{"class":"mercury-dialog mercury-"+this.name+"-dialog loading",style:"display:none"}),this.element.appendTo((e=jQuery(this.options.appendTo).get(0))!=null?e:"body")},e.prototype.bindEvents=function(){return this.element.on("mousedown",function(e){return e.stopPropagation()})},e.prototype.preload=function(){if(this.options.preload)return this.load()},e.prototype.toggle=function(){return this.visible?this.hide():this.show()},e.prototype.resize=function(){return this.show()},e.prototype.show=function(){return Mercury.trigger("hide:dialogs",this),this.visible=!0,this.loaded?(this.element.css({width:"auto",height:"auto"}),this.position(this.visible)):this.position(),this.appear()},e.prototype.position=function(e){},e.prototype.appear=function(){var e=this;return this.element.css({display:"block",opacity:0}),this.element.animate({opacity:.95},200,"easeInOutSine",function(){if(!e.loaded)return e.load(function(){return e.resize()})})},e.prototype.hide=function(){return this.element.hide(),this.visible=!1},e.prototype.load=function(e){var t=this;if(!this.url)return;if(!Mercury.preloadedViews[this.url])return jQuery.ajax(this.url,{success:function(n){t.loadContent(n),Mercury.dialogHandlers[t.name]&&Mercury.dialogHandlers[t.name].call(t);if(e)return e()},error:function(){return t.hide(),t.button&&t.button.removeClass("pressed"),Mercury.notify('Mercury was unable to load %s for the "%s" dialog.',t.url,t.name)}});this.loadContent(Mercury.preloadedViews[this.url]),Mercury.dialogHandlers[this.name]&&Mercury.dialogHandlers[this.name].call(this);if(e)return e()},e.prototype.loadContent=function(e){this.loaded=!0,this.element.removeClass("loading"),this.element.html(e);if(Mercury.config.localization.enabled)return this.element.localize(Mercury.locale())},e}()}).call(this);